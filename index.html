<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FoodXpress Order</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --brand:#ff9933;
  --bg:#f7f7f7;
}
*{box-sizing:border-box;}
body{margin:0;font-family:Arial,sans-serif;background:var(--bg);}
.page{display:none;min-height:100vh;background:#fff;}
.page.active{display:block;}
.header{padding:10px 14px;border-bottom:1px solid #ddd;}
.header img{height:40px;}
.topbar{padding:12px 14px;border-bottom:1px solid #ddd;cursor:pointer;}
.content{padding:14px;padding-bottom:90px;}
h2{margin-top:0;text-align:center;}
.search{width:100%;padding:10px;margin:10px 0;}
.restaurant{display:flex;gap:12px;padding:12px;border:1px solid #ddd;margin-bottom:10px;cursor:pointer;}
.restaurant img{width:56px;height:56px;border-radius:6px;}
.open{color:green;font-weight:bold;}
.closed{color:red;font-weight:bold;}
.category{font-weight:bold;font-size:18px;margin-top:16px;}
.item,.cart-item{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #eee;}
.qty{display:flex;align-items:center;gap:8px;}
.qty button{width:28px;height:28px;border:none;background:var(--brand);color:#fff;font-size:18px;}
.cart-bar{position:fixed;bottom:0;left:0;right:0;background:var(--brand);color:#fff;padding:12px 14px;display:none;justify-content:space-between;}
.bill{margin-top:16px;}
.bill div{display:flex;justify-content:space-between;margin-bottom:6px;}
.bill .total{font-weight:bold;font-size:18px;}
button.primary{width:100%;padding:12px;background:var(--brand);color:#fff;border:none;font-size:16px;margin-top:16px;}
input,textarea{width:100%;padding:10px;margin-top:6px;font-size:16px;}
.small{font-size:12px;color:#666;}
</style>
</head>
<body>

<!-- RESTAURANTS -->
<div id="page-restaurants" class="page active">
  <div class="header"><img src="company-logo.png"></div>
  <div class="content">
    <h2>Select Restaurant</h2>
    <input class="search" placeholder="Search restaurant..." oninput="filterRestaurants(this.value)">
    <div id="restaurantList"></div>
  </div>
</div>

<!-- MENU -->
<div id="page-menu" class="page">
  <div class="topbar" onclick="goBack()">← Back</div>
  <div class="header"><img src="company-logo.png"></div>
  <div class="content">
    <h2 id="menuTitle"></h2>
    <div id="menuItems"></div>
  </div>
</div>

<!-- CART -->
<div id="page-cart" class="page">
  <div class="topbar" onclick="goBack()">← Back</div>
  <div class="header"><img src="company-logo.png"></div>
  <div class="content">
    <h2 id="cartRestaurant"></h2>
    <div id="cartItems"></div>

    <div class="bill">
      <div><span>Item Total</span><span id="itemTotal">₹0</span></div>
      <div><span>Delivery Charge</span><span id="deliveryCharge">₹40</span></div>
      <div class="total"><span>Total Payable</span><span id="grandTotal">₹0</span></div>
    </div>

    <button class="primary" onclick="goToAddress()">Continue → Address</button>
  </div>
</div>

<!-- ADDRESS -->
<div id="page-address" class="page">
  <div class="topbar" onclick="goBack()">← Back</div>
  <div class="header"><img src="company-logo.png"></div>
  <div class="content">
    <h2>Delivery Details</h2>

    <label>Name</label>
    <input id="custName">

    <label>Phone</label>
    <input id="custPhone">

    <label>Address</label>
    <textarea id="custAddress"></textarea>

    <button class="primary" onclick="getLocation()">Use my current location</button>
    <p id="locStatus" class="small"></p>

    <button class="primary" onclick="placeOrder()">Place Order</button>
  </div>
</div>

<!-- CART BAR -->
<div id="cartBar" class="cart-bar" onclick="openCart()">
  <span id="cartInfo"></span>
  <span>Checkout →</span>
</div>

<script>
const restaurants=[
{name:"Hotel Anand",open:true},
{name:"Shree Krishna Dhaba",open:true},
{name:"FoodXpress Kitchen",open:false}
];
const menu={
Veg:[{name:"Paneer Butter Masala",price:180},{name:"Veg Kolhapuri",price:160}],
"Non-Veg":[{name:"Chicken Curry",price:200},{name:"Chicken Biryani",price:220}]
};
let cart={},stack=["page-restaurants"],currentRestaurant="",lat="",lng="",mapLink="";
const deliveryCharge=40;

function show(p){document.querySelectorAll(".page").forEach(x=>x.classList.remove("active"));document.getElementById(p).classList.add("active");}
function nav(p){stack.push(p);show(p);}
function goBack(){if(stack.length>1){stack.pop();show(stack[stack.length-1]);}}

function shuffle(a){return a.sort(()=>Math.random()-0.5);}
function renderRestaurants(){
const l=document.getElementById("restaurantList");l.innerHTML="";
[...shuffle(restaurants.filter(r=>r.open)),...restaurants.filter(r=>!r.open)]
.forEach(r=>{
const d=document.createElement("div");
d.className="restaurant";
d.innerHTML=`<img src="rest-logo.png"><div><div>${r.name}</div><div class="${r.open?'open':'closed'}">${r.open?'Open':'Closed'}</div></div>`;
if(r.open)d.onclick=()=>openMenu(r.name);
l.appendChild(d);
});
}
function filterRestaurants(q){
q=q.toLowerCase();
document.querySelectorAll(".restaurant").forEach(r=>r.style.display=r.innerText.toLowerCase().includes(q)?"":"none");
}

function openMenu(name){
currentRestaurant=name;
document.getElementById("menuTitle").innerText=name;
renderMenu();
nav("page-menu");
}
function renderMenu(){
const b=document.getElementById("menuItems");b.innerHTML="";
for(const c in menu){
b.innerHTML+=`<div class="category">${c}</div>`;
menu[c].forEach(i=>{
const q=cart[i.name]||0;
b.innerHTML+=`<div class="item"><div>${i.name}<div class="small">₹${i.price}</div></div>
<div class="qty"><button onclick="upd('${i.name}',-1)">−</button><span>${q}</span><button onclick="upd('${i.name}',1)">+</button></div></div>`;
});
}
}
function upd(i,d){cart[i]=(cart[i]||0)+d;if(cart[i]<=0)delete cart[i];renderMenu();updateBar();}
function updateBar(){
let it=0,t=0;
for(const i in cart){
const p=Object.values(menu).flat().find(x=>x.name===i).price;
it+=cart[i];t+=cart[i]*p;
}
const bar=document.getElementById("cartBar");
if(it===0)bar.style.display="none";
else{bar.style.display="flex";document.getElementById("cartInfo").innerText=`${it} items | ₹${t}`;}
}

function openCart(){
renderCart();
nav("page-cart");
}
function renderCart(){
document.getElementById("cartRestaurant").innerText=currentRestaurant;
const b=document.getElementById("cartItems");b.innerHTML="";
let t=0;
for(const i in cart){
const p=Object.values(menu).flat().find(x=>x.name===i).price;
t+=cart[i]*p;
b.innerHTML+=`<div class="cart-item"><div>${i}<div class="small">₹${p}</div></div>
<div class="qty"><button onclick="upd('${i}',-1)">−</button><span>${cart[i]}</span><button onclick="upd('${i}',1)">+</button></div></div>`;
}
document.getElementById("itemTotal").innerText=`₹${t}`;
document.getElementById("grandTotal").innerText=`₹${t+deliveryCharge}`;
}

function goToAddress(){nav("page-address");}

function getLocation(){
if(!navigator.geolocation){document.getElementById("locStatus").innerText="Location not supported";return;}
navigator.geolocation.getCurrentPosition(p=>{
lat=p.coords.latitude;lng=p.coords.longitude;
mapLink=`https://www.google.com/maps?q=${lat},${lng}`;
document.getElementById("locStatus").innerText="Location captured ✓";
},()=>document.getElementById("locStatus").innerText="Location permission denied");
}

function placeOrder(){
alert(
"Order Ready\n"+
"Restaurant: "+currentRestaurant+"\n"+
"Items: "+JSON.stringify(cart)+"\n"+
"Address: "+custAddress.value+"\n"+
"Map: "+mapLink
);
}

renderRestaurants();
</script>
</body>
</html>
