<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>20nagar Food Xpress</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root { --brand:#ff9933; }
body { margin:0; font-family:Arial, sans-serif; background:#f7f7f7; }
.page { display:none; min-height:100vh; background:#fff; }
.page.active { display:block; }
.header { padding:10px; border-bottom:1px solid #ddd; text-align:center; }
.header h1 { margin:0; font-size:18px; }
.topbar { padding:12px; border-bottom:1px solid #ddd; cursor:pointer; }
.content { padding:14px; padding-bottom:90px; }
h2 { text-align:center; margin-top:0; }

.search { width:100%; padding:10px; margin:10px 0; }

.restaurant {
  display:flex; gap:12px; padding:12px;
  border:1px solid #ddd; margin-bottom:10px; cursor:pointer;
}
.restaurant img { width:56px; height:56px; border-radius:6px; }
.open { color:green; font-weight:bold; }
.closed { color:red; font-weight:bold; }
.small { font-size:12px; color:#666; }

.category { font-weight:bold; font-size:18px; margin-top:16px; }

.item, .cart-item {
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 0; border-bottom:1px solid #eee;
}

.qty { display:flex; align-items:center; gap:8px; }
.qty button {
  width:28px; height:28px; border:none;
  background:var(--brand); color:#fff; font-size:18px;
}

.cart-bar {
  position:fixed; bottom:0; left:0; right:0;
  background:var(--brand); color:#fff;
  padding:12px; display:none;
  justify-content:space-between; cursor:pointer;
}

.bill div { display:flex; justify-content:space-between; margin-bottom:6px; }
.bill .total { font-weight:bold; font-size:18px; }

button.primary {
  width:100%; padding:12px;
  background:var(--brand); color:#fff;
  border:none; font-size:16px; margin-top:16px;
}

input, textarea {
  width:100%; padding:10px; margin-top:6px; font-size:16px;
}
</style>
</head>
<body>

<!-- PAGE 1: RESTAURANTS -->
<div id="page-restaurants" class="page active">
  <div class="header"><h1>20nagar Food Xpress</h1></div>
  <div class="content">
    <h2>Select Restaurant</h2>
    <input class="search" placeholder="Search restaurant..." oninput="filterRestaurants(this.value)">
    <div id="restaurantList"></div>
  </div>
</div>

<!-- PAGE 2: MENU -->
<div id="page-menu" class="page">
  <div class="topbar" onclick="backToRestaurants()">← Back</div>
  <div class="header"><h1>20nagar Food Xpress</h1></div>
  <div class="content">
    <h2 id="menuTitle"></h2>
    <div id="menuItems"></div>
  </div>
</div>

<!-- PAGE 3: ORDER SUMMARY -->
<div id="page-summary" class="page">
  <div class="topbar" onclick="goBack()">← Back</div>
  <div class="header"><h1>20nagar Food Xpress</h1></div>
  <div class="content">
    <h2>Order Summary</h2>
    <h3 id="summaryRestaurant"></h3>
    <div id="summaryItems"></div>

    <div class="bill">
      <div><span>Item Total</span><span id="itemTotal">₹0</span></div>
      <div><span>Delivery Charge</span><span>₹40</span></div>
      <div class="total"><span>Total Payable</span><span id="grandTotal">₹0</span></div>
    </div>

    <button class="primary" onclick="goToAddress()">Continue → Address</button>
  </div>
</div>

<!-- PAGE 4: ADDRESS -->
<div id="page-address" class="page">
  <div class="topbar" onclick="goBack()">← Back</div>
  <div class="header"><h1>20nagar Food Xpress</h1></div>
  <div class="content">
    <h2>Delivery Details</h2>

    <label>Name</label>
    <input id="custName">

    <label>Phone</label>
    <input id="custPhone">

    <label>Address</label>
    <textarea id="custAddress"></textarea>

    <button class="primary" onclick="captureLocation()">Use my current location</button>
    <p id="locStatus" class="small"></p>

    <button class="primary" onclick="placeOrder()">Place Order</button>
  </div>
</div>

<!-- CART BAR (MENU ONLY) -->
<div id="cartBar" class="cart-bar" onclick="openSummary()">
  <span id="cartInfo"></span>
  <span>View Order →</span>
</div>

<script>
/* DATA */
const restaurants = [
  {name:"Hotel Anand",open:true,hrs:"9:00–14:00, 18:00–23:00"},
  {name:"Shree Krishna Dhaba",open:true,hrs:"10:00–15:00, 19:00–23:30"},
  {name:"FoodXpress Kitchen",open:false,hrs:"11:00–16:00, 18:00–22:00"}
];

const menus = {
  "Hotel Anand": {
    Veg:[{n:"Paneer Butter Masala",p:180}],
    "Non-Veg":[{n:"Chicken Biryani",p:220}]
  },
  "Shree Krishna Dhaba": {
    Veg:[{n:"Veg Kolhapuri",p:160}],
    "Non-Veg":[{n:"Chicken Curry",p:200}]
  }
};

let cart={}, currentRestaurant="", stack=["page-restaurants"];
let lat="", lng="", mapLink="";
const deliveryCharge=40;

/* NAV */
function show(p){
  document.querySelectorAll(".page").forEach(x=>x.classList.remove("active"));
  document.getElementById(p).classList.add("active");
}
function nav(p){ stack.push(p); show(p); }
function goBack(){ stack.pop(); show(stack[stack.length-1]); }
function backToRestaurants(){
  cart={}; updateCartBar();
  stack=["page-restaurants"];
  show("page-restaurants");
}

/* RESTAURANTS */
function renderRestaurants(){
  restaurantList.innerHTML="";
  restaurants.forEach(r=>{
    const d=document.createElement("div");
    d.className="restaurant";
    d.innerHTML=`
      <div>
        <div>${r.name}</div>
        <div class="${r.open?'open':'closed'}">${r.open?'Open':'Closed'}</div>
        ${!r.open?`<div class="small">Hours: ${r.hrs}</div>`:""}
      </div>`;
    if(r.open) d.onclick=()=>openMenu(r.name);
    restaurantList.appendChild(d);
  });
}
function filterRestaurants(q){
  q=q.toLowerCase();
  document.querySelectorAll(".restaurant").forEach(r=>{
    r.style.display=r.innerText.toLowerCase().includes(q)?"":"none";
  });
}

/* MENU */
function openMenu(name){
  cart={};
  currentRestaurant=name;
  menuTitle.innerText=name;
  renderMenu();
  nav("page-menu");
}
function renderMenu(){
  menuItems.innerHTML="";
  const m=menus[currentRestaurant];
  for(const c in m){
    menuItems.innerHTML+=`<div class="category">${c}</div>`;
    m[c].forEach(i=>{
      const q=cart[i.n]||0;
      menuItems.innerHTML+=`
        <div class="item">
          <div>${i.n}<div class="small">₹${i.p}</div></div>
          <div class="qty">
            <button onclick="upd('${i.n}',${i.p},-1)">−</button>
            <span>${q}</span>
            <button onclick="upd('${i.n}',${i.p},1)">+</button>
          </div>
        </div>`;
    });
  }
  updateCartBar();
}

/* UPDATE CART */
function upd(n,p,d){
  cart[n]=(cart[n]||0)+d;
  if(cart[n]<=0) delete cart[n];

  if(stack[stack.length-1]==="page-menu") renderMenu();
  else if(stack[stack.length-1]==="page-summary") renderSummary();

  updateCartBar();
}

/* CART BAR */
function updateCartBar(){
  let items=0,total=0;
  for(const i in cart){
    items+=cart[i];
    total+=cart[i]*getPrice(i);
  }
  if(items>0 && stack[stack.length-1]==="page-menu"){
    cartBar.style.display="flex";
    cartInfo.innerText=`${items} items | ₹${total}`;
  } else {
    cartBar.style.display="none";
  }
}

/* SUMMARY */
function openSummary(){
  renderSummary();
  nav("page-summary");
}
function renderSummary(){
  summaryRestaurant.innerText=currentRestaurant;
  summaryItems.innerHTML="";
  let total=0;
  for(const i in cart){
    const p=getPrice(i);
    total+=cart[i]*p;
    summaryItems.innerHTML+=`
      <div class="cart-item">
        <div>${i}<div class="small">₹${p}</div></div>
        <div class="qty">
          <button onclick="upd('${i}',${p},-1)">−</button>
          <span>${cart[i]}</span>
          <button onclick="upd('${i}',${p},1)">+</button>
        </div>
      </div>`;
  }
  itemTotal.innerText=`₹${total}`;
  grandTotal.innerText=`₹${total+deliveryCharge}`;
}

/* ADDRESS */
function goToAddress(){ nav("page-address"); }
function captureLocation(){
  if(!navigator.geolocation){
    locStatus.innerText="Location not supported";
    return;
  }
  navigator.geolocation.getCurrentPosition(pos=>{
    lat=pos.coords.latitude;
    lng=pos.coords.longitude;
    mapLink=`https://www.google.com/maps?q=${lat},${lng}`;
    locStatus.innerText="Location captured ✓";
  },()=>locStatus.innerText="Permission denied");
}

/* PLACE ORDER */
function placeOrder(){
  let text=`20nagar Food Xpress\n\nRestaurant:\n${currentRestaurant}\n\nItems:\n`;
  let total=0;
  for(const i in cart){
    const p=getPrice(i);
    total+=cart[i]*p;
    text+=`• ${i} × ${cart[i]} = ₹${cart[i]*p}\n`;
  }
  text+=`\nItem Total: ₹${total}\nDelivery Charge: ₹${deliveryCharge}\nTotal Payable: ₹${total+deliveryCharge}\n\nCustomer:\nName: ${custName.value}\nPhone: ${custPhone.value}\nAddress: ${custAddress.value}\n\nLocation:\n${mapLink}`;
  navigator.clipboard.writeText(text).then(()=>{
    alert("Order copied. Paste and send on WhatsApp.");
  });
}

function getPrice(n){
  return Object.values(menus[currentRestaurant]).flat().find(x=>x.n===n).p;
}

renderRestaurants();
</script>
</body>
</html>
